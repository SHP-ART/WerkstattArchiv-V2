# Werkstatt-Archiv Docker Compose
# Einfaches Starten mit: docker-compose up -d

version: '3.8'

services:
  werkstatt-archiv:
    build:
      context: ..              # Elternverzeichnis (Projekt-Root)
      dockerfile: docker/Dockerfile
    container_name: werkstatt-archiv
    restart: unless-stopped
    
    # ============================================================
    # NETZWERK: Zugriff von allen Rechnern im LAN
    # ============================================================
    ports:
      - "0.0.0.0:8080:8080"  # Erreichbar unter http://<SERVER-IP>:8080
    
    volumes:
      # ============================================================
      # PERSISTENTE DATEN (werden NICHT gelöscht beim Neustart)
      # ============================================================
      
      # Konfiguration (Docker-spezifische Config)
      - ./.archiv_config_docker.json:/app/.archiv_config.json
      
      # Logs
      - ../logs:/app/logs
      
      # ============================================================
      # NETZWERK-ORDNER
      # ============================================================
      # WINDOWS: Laufwerk W: wird automatisch von docker_start.bat verbunden
      # macOS/Linux: Lokale Pfade oder Netzwerk-Mounts verwenden
      #
      # ANPASSEN FÜR IHR SYSTEM:
      # ============================================================
      
      # --- WINDOWS (auskommentiert) ---
      # - W:/Archiv:/data/archiv
      # - W:/Eingang:/data/eingang
      # - W:/Backup:/data/backup
      
      # --- macOS / Linux (lokale Test-Ordner) ---
      - ../test_archiv:/data/archiv
      - ../test_input:/data/eingang
      - ../test_backup:/data/backup
    
    environment:
      # Zeitzone
      - TZ=Europe/Berlin
      
      # Log-Level (DEBUG, INFO, WARNING, ERROR)
      - LOG_LEVEL=INFO
    
    # Ressourcen-Limits (optional)
    deploy:
      resources:
        limits:
          memory: 2G
        reservations:
          memory: 512M

# Netzwerk
networks:
  default:
    name: werkstatt-network
